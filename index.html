document.getElementById("formPonto").addEventListener("submit", async function(e) {
  e.preventDefault();
  
  const form = e.target;
  const mensagem = document.getElementById("mensagem");
  mensagem.innerText = "Enviando dados...";
  mensagem.style.color = "blue";

  try {
    // Converter FormData para objeto
    const formData = new FormData(form);
    const data = {};
    formData.forEach((value, key) => data[key] = value);
    
    // URL do Web App - SUBSTITUA pela sua URL real
    const webAppUrl = "https://script.google.com/macros/s/AKfycb.../exec";
    
    // Solução para problemas de CORS
    const proxyUrl = `https://cors-anywhere.herokuapp.com/${webAppUrl}`;
    
    const response = await fetch(proxyUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "X-Requested-With": "XMLHttpRequest"
      },
      body: new URLSearchParams(data).toString()
    });

    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    
    const result = await response.text();
    mensagem.innerText = result;
    mensagem.style.color = "green";
    form.reset();
  } catch (error) {
    console.error("Erro na requisição:", error);
    mensagem.innerText = `Erro: ${error.message}`;
    mensagem.style.color = "red";
    
    // Sugestões para o usuário
    setTimeout(() => {
      mensagem.innerText += "\nTente: 1) Recarregar a página 2) Verificar conexão 3) Contatar suporte";
    }, 2000);
  }
});
